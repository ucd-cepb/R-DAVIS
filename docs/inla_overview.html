<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>INLA? INLA!</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />
<link rel="stylesheet" href="site_libs_extra/academicons-1.8.0/css/academicons.css"/>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-info-circle  fa-1x"></span>
     
    About
  </a>
</li>
<li>
  <a href="syllabus.html">
    <span class="fa fa-map fa-1x"></span>
     
    Syllabus
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Set Up
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="computer_setup.html">Computer Setup</a>
    </li>
    <li>
      <a href="setting_up_git.html">Setting up Git Repository</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book  fa-1x"></span>
     
    Course Materials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="lesson_01_intro_r_rstudio.html">Intro to Programming, R, &amp; RStudio</a>
    </li>
    <li>
      <a href="lesson_02_project_management.html">Project Management</a>
    </li>
    <li>
      <a href="lesson_03_how_r_thinks_about_data.html">How R Thinks About Data</a>
    </li>
    <li>
      <a href="lesson_04_spreadsheets_condensed.html">Spreadsheets</a>
    </li>
    <li>
      <a href="lesson_05_data_import.html">Starting With Spreadsheets in R</a>
    </li>
    <li>
      <a href="lesson_06_data_manipulation_pt1.html">Data Manipulation Pt1</a>
    </li>
    <li>
      <a href="lesson_08_data_manipulation_pt2.html">Data Manipulation Pt2</a>
    </li>
    <li>
      <a href="lesson_09_data_viz_pt1.html">Data Visualization Pt1</a>
    </li>
    <li>
      <a href="lesson_11_data_viz_pt2.html">Data Visualization Pt2</a>
    </li>
    <li>
      <a href="lesson_12_lubridate.html">Date-times with lubridate</a>
    </li>
    <li>
      <a href="lesson_13_functions.html">Writing functions</a>
    </li>
    <li>
      <a href="lesson_14_iteration.html">Iteration</a>
    </li>
    <li>
      <a href="lesson_rmarkdown.html">Literate Programming with RMarkdown</a>
    </li>
  </ul>
</li>
<li>
  <a href="lectures.html">
    <span class="fa fa-slideshare fa-1x"></span>
     
    Lectures
  </a>
</li>
<li>
  <a href="assignments.html">
    <span class="fa fa-paperclip fa-1x"></span>
     
    Assignments
  </a>
</li>
<li>
  <a href="resources.html">
    <span class="fa fa-list"></span>
     
    Resources
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="contact.html">
    <span class="fa fa-hand-spock-o"></span>
     
    Contact
  </a>
</li>
<li>
  <a href="https://github.com/ucd-cepb/R-DAVIS">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">INLA? INLA!</h1>

</div>


<br>
<div class = "blue">
<div id="learning-objectives" class="section level2">
<h2>Learning objectives</h2>
<ul>
<li>Why is INLA?</li>
<li>What is INLA?</li>
<li>Worked example</li>
<li>More examples</li>
</ul>
<p>Basically, I want you to be aware this is a thing and have a vague
sense that this could work for your modeling task in the future</p>
</div>
<div id="why-is-inla" class="section level2">
<h2>Why is INLA?</h2>
<p>We often focus on specific types of models: spatial models, time
series models, hierarchical models, graphical models, GAMs (?)… But
fundamentally, all of these types can be understood as specific
instances of “richly parameterized linear models” (see Hodges 2013)
(i.e., it’s all random effects). These models don’t have to be Bayesian,
but often are. There are theoretical benefits, but practically Bayesian
models are useful for setting up complex parameterizations.</p>
<p>Most Bayesian estimation uses Markov-chain Monte Carlo (MCMC)
sampling –&gt; sample from a high dimensional probability distribution,
keep sampling until you get results with desireable properties (like
maximum likelihood of parameters given the data). MCMC estimation works
well, but it’s slooowwww…. and if you’ve ever played with JAGS or Stan
or similar tools, it’s not that easy to get rolling.</p>
<p>Integrated nested Laplace approximation (INLA) is an alternative
approach –&gt; “approximate Bayesian inference”, i.e., integration to
derive results rather than a sampling method. What you need to know is
in most applications it’s faster than MCMC and it’s about as accurate
(more or less depending on context). Also <strong>INLA IS BUILT WITH
REASONABLE DEFAULT PRIORS</strong>. In other words, you can plug in
priors if you want, but if you don’t want, the thing just works.</p>
</div>
<div id="what-is-inla" class="section level2">
<h2>What is INLA?</h2>
<p>Nobody really knows <em>why</em> INLA works, but we do know
<em>how</em> INLA works: using something called Gaussian Markov random
fields (GMRFs). The key word here is <em>Markov</em>; the idea of a GMRF
is that values are independent of one another conditional on their
neighbors. You are likely familiar with this sort of thing in a spatial
model, with areal or point process data. But GMRFs are also good for
breaking complex dependency structures into statistically tractable
chunks, so can be used to regression models more generally.</p>
<p>At some point, we should have a convo about GMRFs, sparse matrices,
Laplace approximation, and the nitty gritty of how INLA works. But for
now, let’s just trust that it does.</p>
<ul>
<li>Before proceeding, a few definitions are helpful (you’ll see these
in INLA tutorials and papers):
<ul>
<li><em>prior [distribution]</em>: quantified uncertainty about a
parameter before you model any data</li>
<li><em>posterior [distribution]</em>: quantified uncertainty about a
parameter based on prior distribution + probability distribution of new
data.</li>
<li><em>precision matrix</em>: the inverse of a covariate matrix (i.e.,
1 / covariate matrix)</li>
<li><em>hyperparameter</em>: a parameter of a prior distribution</li>
</ul></li>
</ul>
</div>
<div id="worked-example" class="section level1">
<h1>Worked Example</h1>
<p>Let’s start with a simple example: A linear regression $ y_i = + x_i
+ _i $ where <span class="math inline">\(y_i\)</span> is the outcome for
observation <em>i</em>, <span class="math inline">\(\beta\)</span> is a
linear parameter estimated for covariate <em>x</em> and <span
class="math inline">\(\epsilon\)</span> is the error term.</p>
<pre class="r"><code>## simulate these data for expediency ##
n = 1000
y = rnorm(n)
x = rnorm(n)
test_data = data.frame(y = y, x = x)
library(INLA)
### Gaussian is how statistical elitists say &quot;normal distribution&quot;, i.e., this is a basic linear model
mod = inla(formula = y ~ x,data = test_data,family = &#39;Gaussian&#39;)
### comparison
mod_ols = lm(y ~ x,data = test_data)

### summary.fixed is where the posteriors of the fixed effects live
estimates = mod$summary.fixed

# pretty close!
data.frame(inla = estimates$mean,OLS = mod_ols$coefficients)</code></pre>
<pre><code>##                      inla           OLS
## (Intercept) -2.375223e-02 -2.375223e-02
## x            2.422094e-05  2.422096e-05</code></pre>
<p>And in this case, the confidence interval from the lm() function and
the credible interval from the INLA function end up roughly the same too
(this changes as you play with priors and build out bigger and badder
models)</p>
<pre class="r"><code>cbind(c(&#39;confidence&#39;,&#39;credible&#39;),round(rbind(
confint(mod_ols)[2,],
cbind(estimates$`0.025quant`,estimates$`0.975quant`)[2,]),6))</code></pre>
<pre><code>##                   2.5 %       97.5 %    
## [1,] &quot;confidence&quot; &quot;-0.059472&quot; &quot;0.05952&quot; 
## [2,] &quot;credible&quot;   &quot;-0.059428&quot; &quot;0.059476&quot;</code></pre>
</div>
<div id="what-else-can-i-do" class="section level1">
<h1>What else can I do?</h1>
<p>Basically, the bounds of what is possible in INLA are defined by two
things:</p>
<div id="likelihood-families" class="section level2">
<h2>Likelihood families</h2>
<p>INLA has <em>a lot</em> of built in likelihoods. You can view by
calling:</p>
<pre class="r"><code>inla.list.models(&#39;likelihood&#39;)</code></pre>
<pre><code>## Section [likelihood]
##      0binomial                     New 0-inflated Binomial                 
##      0binomialS                    New 0-inflated Binomial Swap            
##      0poisson                      New 0-inflated Poisson                  
##      0poissonS                     New 0-inflated Poisson Swap             
##      agaussian                     The aggregated Gaussian likelihoood     
##      bell                          The Bell likelihood                     
##      beta                          The Beta likelihood                     
##      betabinomial                  The Beta-Binomial likelihood            
##      betabinomialna                The Beta-Binomial Normal approximation likelihood
##      bgev                          The blended Generalized Extreme Value likelihood
##      binomial                      The Binomial likelihood                 
##      cbinomial                     The clustered Binomial likelihood       
##      cennbinomial2                 The CenNegBinomial2 likelihood (similar to cenpoisson2)
##      cenpoisson                    Then censored Poisson likelihood        
##      cenpoisson2                   Then censored Poisson likelihood (version 2)
##      circularnormal                The circular Gaussian likelihoood       
##      coxph                         Cox-proportional hazard likelihood      
##      dgp                           Discrete generalized Pareto likelihood  
##      exponential                   The Exponential likelihood              
##      exponentialsurv               The Exponential likelihood (survival)   
##      fmri                          fmri distribution (special nc-chi)      
##      fmrisurv                      fmri distribution (special nc-chi)      
##      gamma                         The Gamma likelihood                    
##      gammacount                    A Gamma generalisation of the Poisson likelihood
##      gammajw                       A special case of the Gamma likelihood  
##      gammajwsurv                   A special case of the Gamma likelihood (survival)
##      gammasurv                     The Gamma likelihood (survival)         
##      gaussian                      The Gaussian likelihoood                
##      gaussianjw                    The GaussianJW likelihoood              
##      gev                           The Generalized Extreme Value likelihood
##      gompertz                      gompertz distribution                   
##      gompertzsurv                  gompertz distribution                   
##      gp                            Generalized Pareto likelihood           
##      gpoisson                      The generalized Poisson likelihood      
##      iidgamma                      (experimental)                          
##      iidlogitbeta                  (experimental)                          
##      loggammafrailty               (experimental)                          
##      logistic                      The Logistic likelihoood                
##      loglogistic                   The loglogistic likelihood              
##      loglogisticsurv               The loglogistic likelihood (survival)   
##      lognormal                     The log-Normal likelihood               
##      lognormalsurv                 The log-Normal likelihood (survival)    
##      logperiodogram                Likelihood for the log-periodogram      
##      nbinomial                     The negBinomial likelihood              
##      nbinomial2                    The negBinomial2 likelihood             
##      nmix                          Binomial-Poisson mixture                
##      nmixnb                        NegBinomial-Poisson mixture             
##      poisson                       The Poisson likelihood                  
##      poisson.special1              The Poisson.special1 likelihood         
##      pom                           Likelihood for the proportional odds model
##      qkumar                        A quantile version of the Kumar likelihood
##      qloglogistic                  A quantile loglogistic likelihood       
##      qloglogisticsurv              A quantile loglogistic likelihood (survival)
##      simplex                       The simplex likelihood                  
##      sn                            The Skew-Normal likelihoood             
##      stochvol                      The Gaussian stochvol likelihood        
##      stochvolnig                   The Normal inverse Gaussian stochvol likelihood
##      stochvolsn                    The SkewNormal stochvol likelihood      
##      stochvolt                     The Student-t stochvol likelihood       
##      t                             Student-t likelihood                    
##      tstrata                       A stratified version of the Student-t likelihood
##      tweedie                       Tweedie distribution                    
##      weibull                       The Weibull likelihood                  
##      weibullsurv                   The Weibull likelihood (survival)       
##      wrappedcauchy                 The wrapped Cauchy likelihoood          
##      xbinomial                     The Binomial likelihood (expert version)
##      xpoisson                      The Poisson likelihood (expert version) 
##      zeroinflatedbetabinomial0     Zero-inflated Beta-Binomial, type 0     
##      zeroinflatedbetabinomial1     Zero-inflated Beta-Binomial, type 1     
##      zeroinflatedbetabinomial2     Zero inflated Beta-Binomial, type 2     
##      zeroinflatedbinomial0         Zero-inflated Binomial, type 0          
##      zeroinflatedbinomial1         Zero-inflated Binomial, type 1          
##      zeroinflatedbinomial2         Zero-inflated Binomial, type 2          
##      zeroinflatedcenpoisson0       Zero-inflated censored Poisson, type 0  
##      zeroinflatedcenpoisson1       Zero-inflated censored Poisson, type 1  
##      zeroinflatednbinomial0        Zero inflated negBinomial, type 0       
##      zeroinflatednbinomial1        Zero inflated negBinomial, type 1       
##      zeroinflatednbinomial1strata2 Zero inflated negBinomial, type 1, strata 2
##      zeroinflatednbinomial1strata3 Zero inflated negBinomial, type 1, strata 3
##      zeroinflatednbinomial2        Zero inflated negBinomial, type 2       
##      zeroinflatedpoisson0          Zero-inflated Poisson, type 0           
##      zeroinflatedpoisson1          Zero-inflated Poisson, type 1           
##      zeroinflatedpoisson2          Zero-inflated Poisson, type 2           
##      zeroninflatedbinomial2        Zero and N inflated binomial, type 2    
##      zeroninflatedbinomial3        Zero and N inflated binomial, type 3</code></pre>
<p>What’s missing? Basically the only thing not in here is the
multinomial likelihood… but you can use the <a
href="https://www.r-inla.org/faq#h.u3cjqz72sb5o">Poisson trick</a>…
perhaps a convo for another day.</p>
</div>
<div id="latent-models" class="section level2">
<h2>Latent models</h2>
<p>What is a latent model? Some sort of underlying structure you impose
on the data that turns it from just a bag of <span
class="math inline">\(y_i\)</span> values into some sort of arrangement
of <span class="math inline">\(y_i\)</span> values. For instance, you
can include what we traditionally call a “random effect” for groups of
data by adding <code>+ f(group_indicator, model = 'iid')</code> to your
formula. If you view the help doc for the <em>iid</em> model by calling
<code>inla.doc("iid")</code>, a PDF will pop on on your computer that
shoes how the term works, what the other options are (e.g., do you want
to specify a prior, constrain the the estimate, copy the parameter from
another term, etc.). There are a lot of latent models, which you can
list by calling <code>inla.list.models('latent')</code>. Common examples
include the <em>iid</em>, <em>ar</em> (autoregressive) and <em>rw1</em>
/ <em>rw2</em> (random walk) models, and spatial terms like the
<em>Besag</em> or <em>BYM</em> approaches for areal spatial data.</p>
</div>
<div id="other-features" class="section level2">
<h2>Other features</h2>
<p>The likelihood and latent model functionality is really all you need
to get started. Once you get going, you can also specify different types
of priors, create groupings or copies of latent models (e.g., like if
you wanted to specify a random walk model with a separate random walk
for subgroups of observations).</p>
</div>
</div>
<div id="how-do-i-actually-do-this" class="section level1">
<h1>How do I actually do this?</h1>
<p>The best place to start is with someone else’s worked example.
Figuring out all the syntax and settings is hard. There are great
tutorials and worked examples on the primary <a
href="https://www.r-inla.org/examples-tutorials">INLA webpage</a> and
Virgil Gomez-Rubio as an <a
href="https://becarioprecario.bitbucket.io/inla-gitbook/">open source
bitbucket version</a> of his INLA textbook that has tons of code and
examples.</p>
<div id="example-1-bym-model" class="section level2">
<h2>Example 1: BYM model</h2>
</div>
<div id="example-2-joint-likelihood-hurdle-model"
class="section level2">
<h2>Example 2: Joint likelihood (hurdle) model</h2>
</div>
</div>
<div id="tips-tricks-and-questions" class="section level1">
<h1>Tips, tricks, and questions</h1>
<div id="the-sd-of-my-posterior-is-huge-and-the-mean-is-basically-zero"
class="section level2">
<h2>The SD of my posterior is huge and the mean is basically zero??</h2>
<p>A few possibilities: (1) make sure you don’t have a bunch of NA
values; (2) make sure the variable isn’t completely correlated with
another variable; (3) check the scale of model inputs. It could be that
you just have bad data and the model is legitimately like giving you an
emoji shrug. But usually it’s indicative of a problem.</p>
</div>
<div id="should-i-scale-and-center-things" class="section level2">
<h2>Should I scale and center things?</h2>
<p>In general, yes. Hierarchical Bayesian models work better when inputs
are of similar magnitude and inputs are mean-centered (so “0” values are
“average”). For minor differences, this won’t matter, but if you have
some variables measured between 0 and 1 and others measured between $0
and $100M, think about scaling and logging and similar things to make
more commensurate.</p>
</div>
<div id="whats-with-all-the-control.something-function-features"
class="section level2">
<h2>What’s with all the control.[something] function features?</h2>
<p>INLA works out of the box <em>or</em> lets you customize everything.
control.[thing] structured lists are how you do this. INLA has several
control.[thing]s. If you are lost, you can always use helpful, like
<code>?control.fixed</code>. * <code>control.fixed</code>: settings for
priors and desired outputs for unmodeled (“fixed”) effects in model
(i.e., basic regression terms). * <code>control.random</code>: similar
to <code>control.fixed</code>, but for the latent (random effects)
models like <code>rw1</code> or <code>iid</code> terms. *
<code>control.compute</code>: controls calculations and model returns.
For instance, let’s say you wanted to return DIC and WAIC values to
compare model GOFs. You would call
<code>control.compute = list(waic = T,dic = T)</code>. You can also
greatly reduce the size of the returned model object by
<em>reducing</em> returns, such as by calling
<code>control.compute = list(return.marginals = F)</code> if you only
want basic posterior estimates and don’t need more detail about the
marginal estimations. * <code>control.family</code>: How you adjust
settings for the likelihood family, including priors, the link function,
etc. * there are lots of other <code>control.[thing]</code> settings,
which for the most part you don’t need to mess with. Settings I have
adjusted before include <code>control.inla</code> for altering how the
estimation proceeds (like heating up a model) and
<code>control.hazard</code> for hazard functions and survival
models.</p>
</div>
<div id="whats-with-all-the-hyper-x-things-i-see-in-the-example-code"
class="section level2">
<h2>what’s with all the <code>hyper = X</code> things I see in the
example code?</h2>
<p>This is our old friend the <em>hyperparameter</em>…. basically,
<code>hyper</code> is one way that INLA let’s you specify priors using
the <code>hyper</code> setting. So you might see it w/in a latent
<code>iid</code> term <code>f(group,model = 'iid', hyper = X)</code> or
within a <code>control.[thing]</code> setting.</p>
</div>
<div id="how-do-i-export-model-results" class="section level2">
<h2>how do I export model results?</h2>
<p>INLA returns a giant list object. You basically need to navigate hte
list to get what you want. <code>mod$summary.fixed</code> is how you
break into the linear terms, <code>mod$summary.random</code> starts you
towards the modeled effects,</p>
</div>
<div id="tell-me-some-cool-stuff-i-can-do" class="section level2">
<h2>tell me some cool stuff I can do!?</h2>
<p>Yes! So many things! A few things I have done that I’ve found
valuable: (1) it is easy to fit a model, get posteriors, and use those
estimates as priors for a subsequent model (e.g., if you fit a big model
with less data and then a model with more detailed data on a subset of
observations); (2) joint likelihood/hurdle models: basically, you can
dream up any Y matrix structure and make it happen; (3) INLA has
features, beyond the scope here, that let you layer on data that aren’t
directly linked. So like, if you have point process observations (e.g.,
cancer) and want to regress that on features like air quality data that
is measured at <em>other places</em>, you can build a graphical
structure that relates the two. In tutorials if you see references to
things like <code>inla.stack</code>, that’s where the magic is happening
to turn different data parts (e.g., a flat file of regression inputs and
a spatial array of other values) into the necessary model input.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
